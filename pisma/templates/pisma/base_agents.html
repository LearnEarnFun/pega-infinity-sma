{% extends "./base_index.html" %}
{% load static %}


{% block title %}{{ node.name }} Agents {% endblock %}
{% block title_body %}
{{ node.name }} (<a href="{{ node.url }}" target="_blank">{{ node.url }}</a>) / Agents
{% endblock %}


{% block main %}

{% if not error_message %}

<h4>Select cluster member</h4>


<div class="dropdown">
  <a class="btn btn-primary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Cluster member
  </a>

    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <a class="dropdown-item" href="{% url 'pisma:agents_real' node.id 'all'%}">all</a>
        {% for member in cluster_members %}
        <a class="dropdown-item" href="{% url 'pisma:agents_real' node.id member.nodeId%}">
            {{ member.nodeId }} - {{ member.host_name }}
        </a>
        {% endfor %}
    </div>
</div>

{% if real_node_id %}

<h4>Agents</h4>

<table class="table table-striped table-bordered" id="agents_table">
    <thead class="thead-dark">
    <tr>
        <th scope="col">Agent name</th>
        <th scope="col">Ruleset</th>
    </tr>
    </thead>
    <tbody>
    {% for agent in agents %}
    <tr>
        <th scope="row"><a href="{% url 'pisma:agent' node.id real_node_id agent.agent_id%}">{{ agent.agent_name }}</a></th>
        <td>{{ agent.agent_ruleset }}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>

<script>
    $(document).ready( function () {
        $('#agents_table').DataTable();
    } );
</script>


{% endif %}

{% endif %}

{% endblock %}

